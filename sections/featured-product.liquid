<section class="featured-product" data-section-id="{{ section.id }}" data-section-type="featured-product">
  <div class="featured-product__container">
    <div class="featured-product__grid">
      <div class="featured-product__media">
        {%- if section.settings.product.featured_media -%}
          <div class="featured-product__image">
            {{ section.settings.product.featured_media | img_url: 'master' | img_tag: 
              section.settings.product.featured_media.alt,
              'featured-product__img',
              loading: 'lazy'
            }}
          </div>
        {%- endif -%}
      </div>

      <div class="featured-product__details">
        <h2 class="featured-product__title">{{ section.settings.product.title }}</h2>
        
        <div class="featured-product__price-wrapper">
          <div class="featured-product__price">
            <span class="featured-product__current-price">
              {{ section.settings.product.price | money }}
            </span>
            {%- if section.settings.product.compare_at_price > section.settings.product.price -%}
              <span class="featured-product__compare-price">
                {{ section.settings.product.compare_at_price | money }}
              </span>
            {%- endif -%}
          </div>
          {%- if section.settings.product.compare_at_price > section.settings.product.price -%}
            <span class="featured-product__save-text">
              save {{ section.settings.product.compare_at_price | minus: section.settings.product.price | money }}
            </span>
          {%- endif -%}
        </div>

        <div class="featured-product__description">
          {{ section.settings.product.description }}
        </div>

        <div class="featured-product__tags">
          {%- for tag in section.settings.product.tags -%}
            <span class="featured-product__tag">{{ tag }}</span>
          {%- endfor -%}
        </div>

        <form method="post" action="/cart/add" id="product-form-{{ section.id }}" accept-charset="UTF-8" class="featured-product__form" enctype="multipart/form-data">
          <input type="hidden" name="form_type" value="product">
          <input type="hidden" name="utf8" value="âœ“">
          <input type="hidden" name="id" value="{{ section.settings.product.selected_or_first_available_variant.id }}">
          
          <button 
            type="submit" 
            name="add" 
            class="featured-product__submit"
            {% unless section.settings.product.available %} disabled{% endunless %}
          >
            <span>
              {%- if section.settings.product.available -%}
                {{ 'products.product.add_to_cart' | t }}
              {%- else -%}
                {{ 'products.product.sold_out' | t }}
              {%- endif -%}
            </span>
          </button>
        </form>

        <div class="featured-product__accordion">
          <button 
            class="featured-product__accordion-trigger"
            aria-expanded="false"
            aria-controls="materials-content-{{ section.id }}"
          >
            <span>Materials</span>
            <span class="featured-product__accordion-icon" aria-hidden="true">+</span>
          </button>
          <div 
            id="materials-content-{{ section.id }}"
            class="featured-product__accordion-content"
            hidden
          >
            {{ section.settings.materials_content }}
          </div>

          <button 
            class="featured-product__accordion-trigger"
            aria-expanded="false"
            aria-controls="delivery-content-{{ section.id }}"
          >
            <span>Delivery Information</span>
            <span class="featured-product__accordion-icon" aria-hidden="true">+</span>
          </button>
          <div 
            id="delivery-content-{{ section.id }}"
            class="featured-product__accordion-content"
            hidden
          >
            {{ section.settings.delivery_content }}
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
<script>
  class FeaturedProduct extends HTMLElement {
  constructor() {
    super();
    this.accordionTriggers = this.querySelectorAll('.featured-product__accordion-trigger');
    this.init();
  }

  init() {
    this.accordionTriggers.forEach(trigger => {
      trigger.addEventListener('click', () => this.toggleAccordion(trigger));
    });
  }

  toggleAccordion(trigger) {
    const content = document.getElementById(trigger.getAttribute('aria-controls'));
    const isExpanded = trigger.getAttribute('aria-expanded') === 'true';
    
    trigger.setAttribute('aria-expanded', !isExpanded);
    content.hidden = isExpanded;
  }
}

customElements.define('featured-product', FeaturedProduct);
</script>
{% schema %}
{
  "name": "Featured Product",
  "settings": [
    {
      "type": "product",
      "id": "product",
      "label": "Product"
    },
    {
      "type": "richtext",
      "id": "materials_content",
      "label": "Materials Content"
    },
    {
      "type": "richtext",
      "id": "delivery_content",
      "label": "Delivery Content"
    }
  ],
  "presets": [
    {
      "name": "Featured Product",
      "category": "Product"
    }
  ]
}
{% endschema %}